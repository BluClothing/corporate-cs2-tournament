<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Баг бүртгэл - Corporate CS2 Tournament</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center p-6">

<h1 class="text-3xl font-bold mb-4">Баг бүртгэлийн форм</h1>
<form id="regForm" class="w-full max-w-3xl bg-gray-800 p-6 rounded-lg space-y-6">

  <div>
    <label class="block mb-1 text-gray-300">Компани нэр</label>
    <input type="text" name="company" required class="w-full p-2 rounded bg-gray-700">
  </div>

  <div>
    <label class="block mb-1 text-gray-300">Лого зурагны линк (URL)</label>
    <input type="text" name="logo" placeholder="https://..." required class="w-full p-2 rounded bg-gray-700">
  </div>

  <div>
    <label class="block mb-1 text-gray-300">Багийн нэр</label>
    <input type="text" name="teamName" required class="w-full p-2 rounded bg-gray-700">
  </div>

  <h2 class="text-2xl font-semibold mt-4">Тоглогчид</h2>
  <div id="players" class="space-y-4"></div>

  <button type="submit" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded">Илгээх</button>
</form>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxo1ETj3GW6CUItdK71_sR63XoMLQ_5yWDZK4fi132ElLgxFdEIq4jILQ5iZH4DXTSm/exec";

const playersContainer = document.getElementById("players");
const roles = ["Тоглогч 1", "Тоглогч 2", "Тоглогч 3", "Тоглогч 4", "Тоглогч 5", "Сэлгээ"];
roles.forEach((r, i) => {
  playersContainer.innerHTML += `
    <div class="border border-gray-700 p-4 rounded">
      <h3 class="font-semibold mb-2">${r}</h3>
      <input name="player${i}_fullName" placeholder="Овог нэр" class="w-full mb-2 p-2 rounded bg-gray-700">
      <input name="player${i}_nick" placeholder="Никнейм" class="w-full mb-2 p-2 rounded bg-gray-700">
      <input name="player${i}_steam" placeholder="Steam ID" class="w-full mb-2 p-2 rounded bg-gray-700">
      <input name="player${i}_phone" placeholder="Утасны дугаар" class="w-full mb-2 p-2 rounded bg-gray-700">
      <input name="player${i}_work" placeholder="Ажилласан хугацаа (сар)" class="w-full mb-2 p-2 rounded bg-gray-700">
      <input name="player${i}_photo" placeholder="Цээж зураг линк (URL)" class="w-full mb-2 p-2 rounded bg-gray-700">
    </div>`;
});

document.getElementById("regForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const data = { company: fd.get("company"), logo: fd.get("logo"), teamName: fd.get("teamName"), players: [] };
  for(let i=0;i<5;i++){
    data.players.push({
      fullName: fd.get(`player${i}_fullName`),
      nick: fd.get(`player${i}_nick`),
      steam: fd.get(`player${i}_steam`),
      phone: fd.get(`player${i}_phone`),
      work: fd.get(`player${i}_work`),
      photo: fd.get(`player${i}_photo`)
    });
  }
  data.sub = {
    fullName: fd.get(`player5_fullName`),
    nick: fd.get(`player5_nick`),
    steam: fd.get(`player5_steam`),
    phone: fd.get(`player5_phone`),
    work: fd.get(`player5_work`),
    photo: fd.get(`player5_photo`)
  };

  const response = await fetch(SCRIPT_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  const result = await response.json().catch(()=>({status:"success"}));
  alert(result.status==="success"?"Бүртгэл амжилттай!":"Алдаа гарлаа: "+result.message);
  e.target.reset();
});
</script>

</body>
</html>
